{% extends "base-fixed" %}
{% from "macros/form.html" import generate_navigation_database %}
{% block title %}
    wiki - Banco de Dados
{% endblock title %}
{% block extra_css %}
    <link href="https://cdn.jsdelivr.net/npm/prismjs/themes/prism-tomorrow.css"
          rel="stylesheet" />
    <link href="https://cdn.jsdelivr.net/npm/prismjs/plugins/line-numbers/prism-line-numbers.css"
          rel="stylesheet" />
{% endblock extra_css %}
{% block extra_script %}
    <script src="https://cdn.jsdelivr.net/npm/prismjs/prism.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/prismjs/components/prism-markdown.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/prismjs/plugins/line-numbers/prism-line-numbers.min.js"></script>
    <script>
        function copyToClipboard(id) {
            var text = document.getElementById(id).innerText;
            navigator.clipboard.writeText(text)
                .then(() => alert("Copiado!"))
                .catch(err => console.error("Erro ao copiar:", err));
        }
    </script>
{% endblock extra_script %}
{% block content %}
    <pre class="line-numbers" id="wikicode">
<code class="language-markdown"># üìö Documenta√ß√£o do Banco de Dados
{% for table in tables %}
---

## üóÇÔ∏è Tabela: `{{ table }}`

| Coluna | Tipo | Restri√ß√µes | default |
| --- | --- | --- | --- |
{%- for column in columns[table] %}
| {{ column['coluna'] }} | {{ column['tipo'] }} | {{ column['restri√ß√£o'] }} | {{ column['default'] }} |
{%- endfor %}

**Primary Key**:
* `({{ ', '.join(pks[table]['constrained_columns']) }})`
{%- if uks[table] %}

**Unique Key**:
{%- for uk in uks[table] %}
* `({{ ', '.join(uk['column_names']) }})`
{%- endfor %}
{%- endif %}
{%- if fks[table] %}

**Foreign Key**:
{%- for fk in fks[table] %}
* `{{ ', '.join(fk['constrained_columns']) }}` ‚Üí `{{ fk['referred_table'] }}.{{ ', '.join(fk['referred_columns']) }}`
{%- endfor %}
{%- endif %}
{%- if inds[table] %}

**Indexes:**:
{%- for ind in inds[table] %}
* `({{ ', '.join(ind['column_names']) }})`
{%- endfor %}
{%- endif %}
{%- if chks[table] %}

**Check Constraint**:
{%- for chk in chks[table] %}
* `{{ chk['name'] }}`:
  * {{ chk['sqltext'][1:-1] }}
{%- endfor %}
{%- endif %}
{% endfor %}
## ‚úÖ üìå Observa√ß√µes gerais
* ‚úÖ Engine: InnoDB
* ‚úÖ Charset: utf8mb4
* ‚úÖ Collation: utf8mb4_0900_ai_ci (or utf8mb4_general_ci for mysql 5.7)
</code>
    </pre>
    <button onclick="copyToClipboard('wikicode')">Copiar</button>
{% endblock content %}
{#
sqltext = input()
def process_sql_text(sqltext, depth = 0):
    sqltext = sqltext[1:-1]
    lv = 0
    exps = []
    connectives = []
    start, end = None, None
    for i, c in enumerate(sqltext):
        if c == '(':
            if lv == 0:
                start = i
            lv += 1
        elif c == ')':
            lv -= 1
            if lv == 0:
                end = i
        if start is not None and end is not None:
            exp = sqltext[start:end + 1]
            exps.append({"exp":exp, "start":start, "end":end})
            start, end = None, None
    for i in range(len(exps) - 1):
        exp1, exp2 = exps[i], exps[i + 1]
        print(sqltext[exp1['end'] + 1:exp2['start']].strip())
    print(exps)
    return sqltext
#}